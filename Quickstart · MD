# âš¡ å¿«é€Ÿé–‹å§‹æŒ‡å—

5 åˆ†é˜å¿«é€Ÿéƒ¨ç½²åŠ å¯†è²¨å¹£ç›£æ§ç³»çµ±

## ğŸ“‹ å‰ç½®æª¢æŸ¥

ç¢ºèªå·²å®‰è£ä»¥ä¸‹è»Ÿé«”:
```bash
âœ… Python 3.8+
âœ… PostgreSQL 12+
âœ… pip (Python å¥—ä»¶ç®¡ç†å™¨)
```

## ğŸš€ æ–¹æ³•ä¸€: è‡ªå‹•å®‰è£è…³æœ¬ï¼ˆæ¨è–¦ï¼‰

### Step 1: è³¦äºˆåŸ·è¡Œæ¬Šé™
```bash
chmod +x start.sh
```

### Step 2: åŸ·è¡Œå•Ÿå‹•è…³æœ¬
```bash
./start.sh
```

### Step 3: ä¾åºé¸æ“‡é¸é …
```
1. å®‰è£ä¾è³´å¥—ä»¶
2. åˆå§‹åŒ–è³‡æ–™åº«
3. å•Ÿå‹•æ‰€æœ‰æœå‹™
```

### Step 4: å®Œæˆï¼
- å‰ç«¯ç¶²ç«™: http://localhost:8000/static/index.html
- API æ–‡æª”: http://localhost:8000/docs
- Grafana: http://localhost:3000 (éœ€å¦å¤–å®‰è£)

## ğŸ”§ æ–¹æ³•äºŒ: æ‰‹å‹•å®‰è£

### 1. å®‰è£ Python å¥—ä»¶
```bash
pip install -r requirements.txt --break-system-packages
```

### 2. è¨­å®šè³‡æ–™åº«å¯†ç¢¼
ç·¨è¼¯ä»¥ä¸‹æª”æ¡ˆï¼Œä¿®æ”¹ `DB_CONFIG` ä¸­çš„ `password`:
- `collectors/main_collector.py`
- `database/db_init.py`
- `scripts/analyze_logs.py`
- `frontend/api_server.py`

### 3. åˆå§‹åŒ–è³‡æ–™åº«
```bash
# å»ºç«‹ PostgreSQL è³‡æ–™åº«
sudo -u postgres psql
CREATE DATABASE crypto_metrics;
CREATE USER crypto_user WITH PASSWORD 'your_password';
GRANT ALL PRIVILEGES ON DATABASE crypto_metrics TO crypto_user;
\q

# åˆå§‹åŒ–è¡¨çµæ§‹
python database/db_init.py init
```

### 4. å•Ÿå‹•æœå‹™
```bash
# çµ‚ç«¯æ©Ÿ 1: æ•¸æ“šæ”¶é›†å™¨
python collectors/main_collector.py

# çµ‚ç«¯æ©Ÿ 2: API ä¼ºæœå™¨
python frontend/api_server.py

# çµ‚ç«¯æ©Ÿ 3: Log åˆ†æï¼ˆå®šæœŸåŸ·è¡Œï¼‰
python scripts/analyze_logs.py
```

## ğŸ³ æ–¹æ³•ä¸‰: Docker éƒ¨ç½²

### å¿«é€Ÿå•Ÿå‹•
```bash
docker-compose up -d
```

### æŸ¥çœ‹æ—¥èªŒ
```bash
docker-compose logs -f collector
docker-compose logs -f api
```

### åœæ­¢æœå‹™
```bash
docker-compose down
```

## ğŸ“Š é©—è­‰å®‰è£

### 1. æª¢æŸ¥è³‡æ–™åº«é€£ç·š
```bash
python -c "import psycopg2; conn = psycopg2.connect(host='localhost', database='crypto_metrics', user='crypto_user', password='your_password'); print('âœ… è³‡æ–™åº«é€£ç·šæˆåŠŸ')"
```

### 2. æª¢æŸ¥ API å¥åº·ç‹€æ…‹
```bash
curl http://localhost:8000/api/health
```

æ‡‰è©²çœ‹åˆ°:
```json
{
  "status": "healthy",
  "database": "connected",
  "timestamp": "2024-12-12T..."
}
```

### 3. æŸ¥çœ‹æ”¶é›†çš„æ•¸æ“š
```bash
# æŸ¥çœ‹ Log æª”æ¡ˆ
tail -f logs/fr_ob_metrics.log
tail -f logs/options_metrics.log

# æˆ–ä½¿ç”¨å•Ÿå‹•è…³æœ¬
./start.sh
# é¸æ“‡ "7. æŸ¥çœ‹æ—¥èªŒ"
```

## ğŸ¯ ä¸‹ä¸€æ­¥

### è¨­å®š Grafanaï¼ˆå¯é¸ï¼‰
1. å®‰è£ Grafana:
   ```bash
   # Ubuntu/Debian
   sudo apt-get install -y adduser libfontconfig1
   wget https://dl.grafana.com/oss/release/grafana_10.0.0_amd64.deb
   sudo dpkg -i grafana_10.0.0_amd64.deb
   sudo systemctl start grafana-server
   
   # macOS
   brew install grafana
   brew services start grafana
   ```

2. é–‹å•Ÿ Grafana: http://localhost:3000
   - é è¨­å¸³å¯†: `admin` / `admin`

3. æ–°å¢ PostgreSQL Data Source:
   - Type: PostgreSQL
   - Host: `localhost:5432`
   - Database: `crypto_metrics`
   - User: `crypto_user`
   - Password: `your_password`

4. åŒ¯å…¥ Dashboard:
   - é»é¸ "+" â†’ "Import"
   - ä¸Šå‚³ `grafana/dashboard.json`

### è¨­å®šå®šæ™‚ä»»å‹™
```bash
# ç·¨è¼¯ crontab
crontab -e

# æ–°å¢ä»¥ä¸‹å…§å®¹
# æ¯å¤©å‡Œæ™¨ 1 é»åŸ·è¡Œ Log åˆ†æ
0 1 * * * cd /path/to/crypto_monitor && python scripts/analyze_logs.py

# æ¯å¤©å‡Œæ™¨ 2 é»å»ºç«‹æœªä¾† 7 å¤©çš„åˆ†ç‰‡è¡¨
0 2 * * * cd /path/to/crypto_monitor && python database/db_init.py prepare 7

# æ¯é€±æ—¥å‡Œæ™¨ 3 é»æ¸…ç† 30 å¤©å‰çš„èˆŠè¡¨
0 3 * * 0 cd /path/to/crypto_monitor && python database/db_init.py cleanup 30
```

## ğŸ” å¸¸è¦‹å•é¡Œ

### Q1: è³‡æ–™åº«é€£ç·šå¤±æ•—
**A**: æª¢æŸ¥ PostgreSQL æ˜¯å¦é‹è¡Œ
```bash
sudo systemctl status postgresql
```

### Q2: Options æ”¶é›†å¤±æ•—
**A**: æª¢æŸ¥ Deribit API æ˜¯å¦å¯ç”¨
```bash
python -c "import ccxt; ex = ccxt.deribit(); print(ex.fetch_markets())"
```

### Q3: å‰ç«¯é¡¯ç¤º"è¼‰å…¥ä¸­..."
**A**: ç¢ºèª API ä¼ºæœå™¨å·²å•Ÿå‹•ä¸¦åŸ·è¡Œé Log åˆ†æ
```bash
# æª¢æŸ¥ API
curl http://localhost:8000/api/health

# åŸ·è¡Œåˆ†æ
python scripts/analyze_logs.py
```

### Q4: Grafana ç„¡æ³•é€£ç·šè³‡æ–™åº«
**A**: ç¢ºèªè³‡æ–™åº«å¯†ç¢¼è¨­å®šæ­£ç¢ºï¼Œä¸¦æ¸¬è©¦é€£ç·š

## ğŸ“ éœ€è¦å¹«åŠ©ï¼Ÿ

æŸ¥çœ‹å®Œæ•´æ–‡æª”: [README.md](README.md)

---

**ç‰ˆæœ¬**: 1.0.0
**æ›´æ–°**: 2024-12-12
